const e=e=>{const t=document.createElement(e.tagName);return Object.entries(e).forEach(function([e,n]){"tagName"!==e&&t.setAttribute(e,n)}),t},t=e=>"object"==typeof e&&null!==e,n=function(e,t){const r=t(e);if(r)return r;const a=e.parentNode;return a?n(a,t):void 0},r=(e,t,n)=>{Object.prototype.hasOwnProperty.call(e,t)?e[t].push(n):e[t]=[n]};let a=Number.MAX_SAFE_INTEGER;const o=()=>{const e=`id-${a}`;return a-=1,e},i=Object.prototype.hasOwnProperty,c=e=>t=>i.call(e,t)?e[t]:e.MISS,l=e=>{e.remove()},s=c({INPUT:"value",TEXTAREA:"value",PROGRESS:"value",SELECT:"value",IMG:"src",SOURCE:"src",AUDIO:"src",VIDEO:"src",TRACK:"src",SCRIPT:"src",OPTION:"value",LINK:"href",DETAILS:"open",MISS:"textContent"}),d=c({checkbox:"checked",radio:"checked",MISS:"value"}),u=c({checkbox:"change",radio:"change",range:"change",file:"change",MISS:"input"}),p=c({SELECT:"change",TEXTAREA:"input",BUTTON:"click",MISS:"click"}),f={"function":"data-function",variable:"data-variable",element:"data-element",list:"data-list",inside:"data-inside",template:"data-template"},m=e=>{let t;return"INPUT"===(t=e.tagName!==undefined?e.tagName:e)?d(e.type):s(t)},h=e=>{const t=e.tagName;return"INPUT"===t?u(e.type):p(t)},E=(e,t)=>{t(e);let n=e.firstChild;for(;n;)1===n.nodeType?(E(n,t),n=n.nextElementSibling):n=n.nextSibling},g=e=>{const t=e.getAttribute("is");return t||e.tagName.toLowerCase()},b=(e,t,n,r=!1)=>{e.addEventListener(t,n,r)},v=e=>(e.content,document.importNode(e.content,!0)),S=e=>e.DOM99_C,O=e=>n(e.target,S)||"",y=e=>e.join(">"),A=e=>{const t=e.split(">");return t.pop(),t.join(">")},N=(e,t)=>0===e.length?t:`${y(e)}>${t}`,T=e=>e?`${e}>`:e,I=(e,t)=>{Object.keys(e).forEach(n=>{n.startsWith(t)&&delete e[n]})},M=e=>defaultValue in e?e.defaultValue:"open"in e?e.open:e.textContent,C=e=>e.value||M(e),{start:D,activate:$,elements:_,functions:R,variables:j,get:F,feed:k,forgetContext:U,deleteTemplate:x,plugin:L,options:P}=(()=>{const e={},n={},a={},o={},c={},s={};let d=[];const u=[];let p=!1;const S=[],O=[];let y;const A={doneSymbol:"*",tokenSeparator:"-",listSeparator:" ",firstVariableValueStrategy:undefined,directives:f,propertyFromElement:m,eventNameFromElement:h,tagNamesForUserInput:["INPUT","TEXTAREA","SELECT","DETAILS"]},M=e=>e.join(">"),C=e=>{d.push(e)},D=function(){d.pop()},$=t=>{I(e,t),I(n,t),I(a,t),I(o,t)},_=(e,t)=>{e[A.propertyFromElement(e)]=t},R=(e,n,r)=>{const a=document.createDocumentFragment();if(i.call(e,"DOM99_X")&&i.call(c,e.DOM99_X)){const t=c[e.DOM99_X],o=(e=>e.slice())(d);d=n.split(">");const s=T(n),u=r.length;let p,f;if(i.call(e,"DOM99_R")){if((p=e.DOM99_R.length)>u){let t;for(t=u;t<p;t+=1)f=`${s}${t}`,e.DOM99_R[t].forEach(l),$(f);e.DOM99_R.length=u}}else e.DOM99_R=[],p=0;r.forEach((n,r)=>{if(j(f=`${s}${r}`,n),r>=p){const n=V(t,String(r));e.DOM99_R.push((e=>{const t=e.length,n=[];let r;for(r=0;r<t;r+=1)n.push(e[r]);return n})(n.childNodes)),a.appendChild(n)}}),d=o}else{e.innerHTML="";const n=e.DOM99_I,o=A.propertyFromElement(n.toUpperCase());r.forEach(e=>{const r=document.createElement(n);t(e)?Object.assign(r,e):r[o]=e,a.appendChild(r)})}e.appendChild(a)},j=(r,o)=>{if(o===undefined&&(o=r,r=""),t(r),p||B(r,o),t(o))if(Array.isArray(o))a[r]=o,i.call(n,r)&&((e,t,n)=>{e.forEach(e=>{R(e,t,n)})})(n[r],r,o);else{const e=T(r);p=!0,Object.entries(o).forEach(([t,n])=>{j(`${e}${t}`,n)}),p=!1}else a[r]=o,i.call(e,r)&&((e,t)=>{t!==undefined&&e.forEach(e=>{_(e,t)})})(e[r],o)},F=(e,t,n)=>{b(e,t,s[n]),e.DOM99_C=M(d)};let k=F;const U=(e,t)=>{t.split(A.listSeparator).forEach(t=>{const n=t.split(A.tokenSeparator);let r,a;1===n.length?(r=n[0],a=A.eventNameFromElement(e)):[a,r]=n,k(e,a,r)})},x=(e,t)=>{const[o,c,l]=t.split(A.tokenSeparator);let s="-";l?(s=`${c}-${l}`,e.DOM99_X=s):e.DOM99_I=c;const u=N(d,o);r(n,u,e),i.call(a,u)&&R(e,u,a[u])},L=(t,n)=>{const o=N(d,n);r(e,o,t),a[o]!==undefined&&_(t,a[o]),A.tagNamesForUserInput.includes(t.tagName)&&b(t,A.eventNameFromElement(t),n=>{const r=t[A.propertyFromElement(t)];a[o]=r,B(o,r),e[o].forEach(e=>{e!==t&&_(e,r)})})},P=(e,t)=>{const n=t,r=N(d,n);o[r]=e},X=(e,t)=>{c[t]=e},V=(e,t)=>{C(t);const n=v(e);return W(n),K(),D(),n},w=(e,t)=>{const n=c[g(e)];if(n){const r=V(n,t);e.appendChild(r)}else e.setAttribute(A.directives.inside,A.doneSymbol+t),C(t),W(e),D()},G=e=>{if(!e.hasAttribute)return;const t=Object.values(A.directives);if(Array.prototype.slice.call(e.attributes).forEach(e=>{e.nodeName.startsWith("data")&&t.includes(e.nodeName)}),y.forEach(([t,n])=>{if(!e.hasAttribute(t))return;const r=e.getAttribute(t);r[0]!==A.doneSymbol&&(n(e,r),e.setAttribute(t,`${A.doneSymbol}${r}`))}),e.hasAttribute(A.directives.inside)||e.hasAttribute(A.directives.list))return;let n=g(e);i.call(c,n)&&e.appendChild(v(c[n]))},W=(e=document.body)=>(y||(y=[[A.directives.element,P],[A.directives.variable,L],[A.directives["function"],U],[A.directives.list,x],[A.directives.inside,w],[A.directives.template,X]]),E(e,G),e),K=function(){const e=M(d);O.forEach(t=>{t(e)})},B=(e,t)=>{S.forEach(n=>{n(e,t)})};return{start:(e={},t={},n=document.body,r=undefined)=>{if(Object.assign(s,e),j(t),W(n),r)return r()},activate:W,elements:o,functions:s,variables:a,get:(e,t)=>{let n;return n=Array.isArray(e)?M(e):e,t&&(n=`${n}>${withWhat}`),a[n]},feed:j,forgetContext:$,deleteTemplate:e=>{i.call(c,e),c[e].remove(),delete c[e]},plugin:e=>{t(e),"function"===e.type?(u.push(e.plugin),k=((e,t,n)=>{let r=!1;const a=function(){r=!0};u.forEach(r=>{r(e,t,n,s,a)}),r||F(e,t,n)})):"variable"===e.type?S.push(e.plugin):"cloned"===e.type&&O.push(e.plugin)},options:A}})();export{D as start,$ as activate,_ as elements,R as functions,j as variables,F as get,k as feed,U as forgetContext,x as deleteTemplate,L as plugin,P as options,y as contextFromArray,O as contextFromEvent,A as getParentContext,e as createElement2,o as idGenerator,M as FIRST_VARIABLE_FROM_HTML,C as FIRST_VARIABLE_FROM_USER_AGENT};