<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Demo</title>
    <meta name="viewport" content="width=device-width">
    <style>.grey{background:#ddd;}</style>
    <link rel="stylesheet" href="css/basics.css">
</head>
<body>    
<p>below an ul element with data-vr="list1-li"</p>
<ul data-list="list1-li"></ul>

<p>simple deep composition without variables</p>

<template data-template="d-xrow">
    <pre>xxxxx</pre>
</template>

<template data-template="d-xsquare">
    <d-xrow></d-xrow>
    <d-xrow></d-xrow>
</template>

<d-xsquare></d-xsquare>

<p>simple deep composition with variables</p>

<template data-template="d-search">
    <label>Search
        <input data-vr="search" data-fx="trySearch" type="search" placeholder="search">
    </label>
    <label>
        Filters
        <input type="text" placeholder="filter" disabled>
    </label>
    <p data-vr="message"></p>
</template>

<template data-template="d-explorer">
    <d-search data-in="dsearch"></d-search>
    <ul data-list="files-li"></ul>
</template>



<d-explorer data-el="exporer1container" data-in="explorer1"></d-explorer>
<d-explorer data-el="exporer2container" data-in="explorer2"></d-explorer>

<script src="../polyfill.min.js"></script>
<!-- <script src="../js/dom99.es5.min.js"></script>  -->
<script src="../js/dom99.js"></script>
<script>
"use strict";
var D = dom99;


D.vr.list1 = ["a","b","c","d"];
D.vr.list1.push("gg");
D.vr.list1 = D.vr.list1;//force update

D.fx.calculate = function (event) {
    //.vr variables are Strings by default
    D.vr.result = Number(D.vr.a) * Number(D.vr.b);
};

D.vr.a = 7;
D.vr.b = 6;
//invoke event handler to compute the first result
D.fx.calculate();

var files = ["beach.jpg","letter_for_johan.txt","letter_for_sintia.txt","recipe.md","readme.md"];
var files2 = ["za.jpg","letter_for_johan.txt","letter_for_sintia.txt","recipe.md","readme.md"];

D.fx.trySearch = function (event) {
    const dSearchContext = D.getParentContext(event.target);
    const dSearchElement = dSearchContext.baseEl;
    const dExplorerContext = D.getParentContext(dSearchElement);
    
    var search = dSearchContext.vr.search


    if (search) {
        dSearchContext.vr.message = "searching: " +  search;
        dSearchElement.className = "grey";
    } else {
        dSearchContext.vr.message = "Displaying all files";
        dSearchElement.className = "";
    }
    
    //console.log(dExplorerContext);

    dExplorerContext.vr.files = dExplorerContext.vr.originalFiles.filter(function (file) {
        return file.match(search);
    });
    
    
};

D.vr.explorer2 = {};
D.vr.explorer2.originalFiles = files2;
D.vr.explorer2.files = D.vr.explorer2.originalFiles;

D.linkJsAndDom();

D.vr.explorer1.files = files;
D.vr.explorer1.originalFiles = files;


</script>
</body>
</html>