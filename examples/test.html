<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Demo</title>
    <meta name="viewport" content="width=device-width">
    <style></style>
</head>
<body>    
<p>below an ul element with data-vr="list1-li"</p>
<ul data-list="list1-li"></ul>

<p>simple deep composition without variables</p>

<template data-el="xrowTemplate-d-xrow">
    <pre>xxxxx</pre>
</template>

<template data-el="xsquareTemplate-d-xsquare">
    <d-xrow></d-xrow>
    <d-xrow></d-xrow>
</template>

<d-xsquare></d-xsquare>

<p>simple deep composition with variables</p>

<template data-el="searchTemplate-d-search">
    <label>Search<input data-vr="search" data-fx="trySearch" type="search" placeholder="search"></label>
    <label>Filters<input type="text" placeholder="filter" disabled></label>
</template>

<template data-el="explorerTemplate-d-explorer">
    <d-search data-in="search"></d-search>
    <p data-vr="message"></p>
    <ul data-list="files-li"></ul>
</template>



<d-explorer data-in="explorer1"></d-explorer>

    
<script src="../js/dom99.js"></script>
<script>
"use strict";
const D = dom99;


D.vr.list1 = ["a","b","c","d"];
D.vr.list1.push("gg");
D.vr.list1 = D.vr.list1;//force update

D.fx.calculate = function (event) {
    //.vr variables are Strings by default
    D.vr.result = Number(D.vr.a) * Number(D.vr.b);
};

D.vr.a = 7;
D.vr.b = 6;
//invoke event handler to compute the first result
D.fx.calculate();

var files = ["beach.jpg","letterforjohan.txt","leterforsintia.txt","recipe.md","readme.md"];
D.fx.trySearch = function (event) {
    var search = D.followPath(D.vr, event.dKeys).search
    event.dKeys.pop();
    //console.log(event.dKeys);
    //event.dIn.vr.message = event.dIn.vr.search.search; does nothing because Object.defineProperty doesn spread to other objects with same pointer
    D.followPath(D.vr, event.dKeys).message = search ? "searching: " +  search : "Displaying all files";
    D.followPath(D.vr, event.dKeys).files = files.filter(function (file) {
        return file.match(search);
    });
    D.followPath(D.vr, event.dKeys).files
    event.dHost.style = "background:blue;";
};
//
D.linkJsAndDom();
D.vr.explorer1.files = files;


</script>
</body>
</html>